<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>勉強タイマー</title>
  <link rel="stylesheet" href="style.css">

  <link rel="manifest" href="manifest.json">

  <meta name="theme-color" content="#4caf50">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="StudyTimer">
  <link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>

<h1>勉強タイマー</h1>

<div class="card">
  <input id="subject" placeholder="勉強内容（例：数学）">
  <input type="color" id="color" value="#36a2eb">
  
  <div id="time">00:00:00</div>

  <button id="toggle">START</button>
  <button id="save">保存</button>
</div>

<h2>YouTube</h2>

<p id="ytRemain">残り：00:00:00</p>

<div id="watchingStatus" style="display:none; background:#ffebee; padding:15px; border-radius:10px; margin-bottom:15px;">
  <p style="color:#d32f2f; font-weight:bold;">視聴中（別タブで開いています）</p>
  <button onclick="stopYouTube()" style="background:#d32f2f; color:white;">視聴を終了して時間を確定</button>
</div>

<button id="openYtBtn" onclick="startYouTube()">YouTubeを開く</button>

<h2>今日の勉強</h2>
<p id="todayTotal">合計：00:00:00</p>
<ul id="todayList"></ul>

<h2>カレンダー</h2>
<p id="monthTotal">月合計：00:00:00</p>
<div style="display:flex; justify-content:space-between; align-items:center;">
  <button onclick="prevMonth()">◀ 前月</button>
  <span id="monthLabel"></span>
  <button onclick="nextMonth()">次月 ▶</button>
</div>
<div id="calendar"></div>

<h2 id="detailTitle">詳細</h2>
<div id="dayDetail">
  <p>日付をタップしてください</p>
</div>

<h2>直近1週間の勉強時間</h2>
<canvas id="weekChart"></canvas>

<h2>今月の科目別割合</h2>
<canvas id="monthPie"></canvas>

<dialog id="editDialog" style="border:none; border-radius:12px; padding:24px; box-shadow: 0 4px 20px rgba(0,0,0,0.25); width: 80%; max-width: 300px;">
  <h3 style="margin-top:0; text-align:center;">記録の編集</h3>
  
  <div style="margin-bottom:15px; text-align:left;">
    <label style="display:block; font-size:12px; margin-bottom:4px; color:#666;">勉強内容</label>
    <input id="editSubject" type="text" style="width:100%; padding:10px; box-sizing:border-box; border:1px solid #ddd; border-radius:6px; font-size:16px;">
  </div>

  <div style="margin-bottom:24px; text-align:left;">
    <label style="display:block; font-size:12px; margin-bottom:4px; color:#666;">色</label>
    
    <div style="display: flex; align-items: center; gap: 10px;">
      <label for="editColor" style="font-size: 32px; cursor: pointer; background: #f0f0f0; border-radius: 8px; width: 50px; height: 50px; display: flex; justify-content: center; align-items: center;">
        🎨
      </label>
      
      <div id="colorPreview" style="width: 30px; height: 30px; border-radius: 50%; border: 1px solid #ccc;"></div>

      <input id="editColor" type="color" style="opacity: 0; width: 0; height: 0; position: absolute;">
    </div>
  </div>

  <div style="display: flex; justify-content: space-between;">
    <button id="cancelEdit" style="background:#ddd; color:#333; border:none; border-radius:6px; padding:10px 20px; font-size:14px;">キャンセル</button>
    <button id="saveEdit" style="background:#4caf50; color:white; border:none; border-radius:6px; padding:10px 20px; font-size:14px;">保存</button>
  </div>
</dialog>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="script.js"></script>

<div id="toast" class="toast">保存しました</div>
</body>
</html>
