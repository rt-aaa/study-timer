<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube</title>
</head>
<body>

<h2>YouTube視聴</h2>
<p id="remain"></p>

<iframe width="100%" height="300"
  src="https://www.youtube.com/embed/VIDEO_ID?autoplay=1"
  allow="autoplay">
</iframe>

<button onclick="exit()">戻る</button>

<script>
let data = JSON.parse(localStorage.getItem("study") || "{}");
let remain = data.youtubeCredit || 0;
const p = document.getElementById("remain");

function format(sec) {
  const m = String(Math.floor(sec / 60)).padStart(2,"0");
  const s = String(sec % 60).padStart(2,"0");
  return `${m}:${s}`;
}

p.textContent = "残り時間：" + format(remain);

const timer = setInterval(() => {
  remain--;
  p.textContent = "残り時間：" + format(remain);

  if (remain <= 0) {
    clearInterval(timer);
    data.youtubeCredit = 0;
    localStorage.setItem("study", JSON.stringify(data));
    alert("時間切れです");
    location.href = "index.html";
  }
}, 1000);

function exit() {
  clearInterval(timer);
  data.youtubeCredit = remain;
  localStorage.setItem("study", JSON.stringify(data));
  location.href = "index.html";
}
</script>

</body>
</html>
